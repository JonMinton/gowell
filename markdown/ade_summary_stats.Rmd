---
title: "diversity means and sds"
author: "Jon Minton"
date: "Tuesday, March 10, 2015"
output: html_document
---

# Request from Ade

Jon,
 
Meantime, do you think you could also produce a table showing the average (mean) values and s.d.s for the diversity scores on each dimension, for  all datazones in Greater Glasgow  and then also separately by SIMD 2012 quintile?
 
Yours,
Ade

#Mean and SDs for diversity scores

```{r prereqs, echo=FALSE, cache=TRUE, results='hide', message=FALSE, warning=FALSE}

# What are the sources of data?
rm(list=ls())

setwd("E:/repos/gowell")


require(repmis)
require(plyr)
require(tidyr)
require(stringr)
require(dplyr)

require(xtable)
require(ggplot2)
require(rgl)

require(vegan)

demo_div <- read.csv("data/derived/demographic_diversity_2010.csv") %>%
    tbl_df %>%
    rename(demographic=diversity)


dtype_div <- read.csv("data/derived/diversity_dwelling_type_2011.csv") %>%
    tbl_df %>%
    rename(dtype=diversity)

eth_div <- read.csv("data/derived/diversity_ethnicity_2011.csv") %>%
    tbl_df %>%
    rename(ethnicity=diversity)

sec_div <- read.csv("data/derived/diversity_sec_by_dz_2011_census.csv") %>%
    tbl_df %>%
    rename(sec=sec_div)

ten_div <- read.csv("data/derived/diversity_tenure_2001.csv" ) %>%
    tbl_df %>%
    rename(tenure=diversity)

spac_div <- read.csv("data/derived/diversity_space_2001.csv") %>%
    tbl_df %>%
    rename(space=diversity)

band_div <- read.csv("data/derived/diversity_dwelling_band_2011.csv") %>%
    tbl_df %>%
    rename(band=diversity)

joined <- Reduce(inner_join, list(demo_div, dtype_div, eth_div, sec_div, ten_div, spac_div, band_div))
```

##Mean and SD of raw results

Here are the mean and SDs of the diversity scores themselves. Such numbers are 
probably not too meaningful to compare as the scales are different. 

```{r table_raw, echo=FALSE, results="asis"}

tmp <- matrix(NA, nrow=7, ncol=2, 
        dimnames=list(
            c("demographic", "dwelling", "ethnic", "socioeconomic", "tenure", "space", "council tax band"),
            c("mean", "sd")
        )
    )

tmp["demographic", "mean"] <- mean(joined$demographic)
tmp["demographic", "sd"] <- sd(joined$demographic)

tmp["dwelling", "mean"] <- mean(joined$dtype)
tmp["dwelling", "sd"] <- sd(joined$dtype)

tmp["ethnic", "mean"] <- mean(joined$ethnicity)
tmp["ethnic", "sd"] <- sd(joined$ethnicity)

tmp["socioeconomic", "mean"] <- mean(joined$sec)
tmp["socioeconomic", "sd"] <- sd(joined$sec)

tmp["tenure", "mean"] <- mean(joined$tenure)
tmp["tenure", "sd"] <- sd(joined$tenure)

tmp["space", "mean"] <- mean(joined$space)
tmp["space", "sd"] <- sd(joined$space)

tmp["council tax band", "mean"] <- mean(joined$band)
tmp["council tax band", "sd"] <- sd(joined$band)

tbl <- xtable(tmp)
print(tbl, type="html")

```

##Mean and results of results rescaled to [0, 1]
Within the factor analyses the scores are each normalised either by rank, or by centile. 
The means and SDs when normalised by centile (0 to 1) are of course as follows


```{r table_centile, echo=FALSE, results="asis"}

joined_centile <- joined %>%
    mutate_each(funs(percent_rank), vars=-datazone)

tmp <- matrix(NA, nrow=7, ncol=2, 
        dimnames=list(
            c("demographic", "dwelling", "ethnic", "socioeconomic", "tenure", "space", "council tax band"),
            c("mean", "sd")
        )
    )

tmp["demographic", "mean"] <- mean(joined_centile$demographic)
tmp["demographic", "sd"] <- sd(joined_centile$demographic)

tmp["dwelling", "mean"] <- mean(joined_centile$dtype)
tmp["dwelling", "sd"] <- sd(joined_centile$dtype)

tmp["ethnic", "mean"] <- mean(joined_centile$ethnicity)
tmp["ethnic", "sd"] <- sd(joined_centile$ethnicity)

tmp["socioeconomic", "mean"] <- mean(joined_centile$sec)
tmp["socioeconomic", "sd"] <- sd(joined_centile$sec)

tmp["tenure", "mean"] <- mean(joined_centile$tenure)
tmp["tenure", "sd"] <- sd(joined_centile$tenure)

tmp["space", "mean"] <- mean(joined_centile$space)
tmp["space", "sd"] <- sd(joined_centile$space)

tmp["council tax band", "mean"] <- mean(joined_centile$band)
tmp["council tax band", "sd"] <- sd(joined_centile$band)

tbl <- xtable(tmp)
print(tbl, type="html")

```

##Mean and SD of raw results

Here are the mean and SDs of the diversity scores themselves. Such numbers are 
probably not too meaningful to compare as the scales are different. 

```{r, echo=FALSE, results="asis"}

tmp <- matrix(NA, nrow=7, ncol=2, 
        dimnames=list(
            c("demographic", "dwelling", "ethnic", "socioeconomic", "tenure", "space", "council tax band"),
            c("mean", "sd")
        )
    )

tmp["demographic", "mean"] <- mean(joined$demographic)
tmp["demographic", "sd"] <- sd(joined$demographic)

tmp["dwelling", "mean"] <- mean(joined$dtype)
tmp["dwelling", "sd"] <- sd(joined$dtype)

tmp["ethnic", "mean"] <- mean(joined$ethnicity)
tmp["ethnic", "sd"] <- sd(joined$ethnicity)

tmp["socioeconomic", "mean"] <- mean(joined$sec)
tmp["socioeconomic", "sd"] <- sd(joined$sec)

tmp["tenure", "mean"] <- mean(joined$tenure)
tmp["tenure", "sd"] <- sd(joined$tenure)

tmp["space", "mean"] <- mean(joined$space)
tmp["space", "sd"] <- sd(joined$space)

tmp["council tax band", "mean"] <- mean(joined$band)
tmp["council tax band", "sd"] <- sd(joined$band)

tbl <- xtable(tmp)
print(tbl, type="html")

```
